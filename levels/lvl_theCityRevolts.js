var theCityRevolts = {
	
	name: "The City Revolts",
	description: "<p>The city of Pileus -- your home -- has erupted in celebration, protest, and violence in the wake of the city council's rebellion from the rule of the Ogre King.  While many welcome the daring move, many others, moved by their loyalty to the King, strenuously object.  Still others see these tumultuous times as an opportunity to settle old scores, lash out against the vulnerable, or descend into looting whatever isn't nailed down.</p><p>Seeking to address the unrest, Guildmaster Moucau has announced he will be speaking in the Orktown slums -- your neighborhood.  It is a rare thing to see a citizen of such means and importance deigning to address the poor and disadvantaged citizens of the city, but these are rare times, indeed.</p><p>This may be an opportunity for you, however: the guildmasters are recruiting and chartering companies of fighters to bolster the city's defenses.  This is your chance to get an audience with the guildmaster and establish your company's status in the city.</p>",
 
 	sizeX: 33,
 	sizeY: 36,
 	
 	background: 'img/theCityRevolts.svg',
 	
 	startLocations: [
 		{x:1,y:2},
 		{x:2,y:2},
 		{x:1,y:3},
 		{x:4,y:1}
 	],
 	
 	walls: [
 		{x:0,y:15},
 		{x:1,y:15},
 		{x:1,y:14},
 		{x:2,y:14},
 		{x:3,y:14},
 		{x:4,y:13},
 		{x:5,y:13},
 		{x:5,y:12},
 		{x:5,y:11},
 		{x:5,y:10},
 		{x:6,y:10},
 		{x:7,y:10},
 		{x:8,y:10},
 		{x:9,y:10},
 		{x:10,y:10},
 		{x:11,y:11},
 		{x:12,y:11},
 		{x:13,y:11},
 		{x:14,y:11},
 		{x:14,y:10},
 		{x:15,y:10},
 		{x:16,y:10},
 		{x:17,y:11},
 		{x:18,y:11},
 		{x:19,y:11},
 		{x:20,y:11},
 		{x:20,y:10},
 		{x:21,y:10},
 		{x:22,y:10},
 		{x:23,y:10},
 		{x:24,y:10},
 		{x:25,y:10},
 		
 		{x:10,y:20},
 		{x:11,y:20},
 		{x:12,y:20},
 		{x:13,y:20},
 		{x:14,y:20},
 		{x:15,y:20},
 		{x:16,y:21},
 		{x:17,y:21},
 		{x:18,y:21},
 		{x:19,y:21},
 		{x:20,y:21},
 		{x:21,y:21},
 		{x:21,y:22},
 		{x:22,y:22},
 		{x:23,y:23},
 		{x:24,y:23},
 		{x:25,y:23},
 		{x:25,y:24},
 		{x:27,y:24},
 		{x:28,y:24},
 		{x:29,y:24},
 		{x:30,y:24},
 		{x:31,y:24},
 		{x:32,y:24},
 		
 		{x:3,y:18},
 		{x:4,y:18},
 		{x:5,y:17},
 		{x:6,y:17},
 		{x:7,y:16},
 		{x:8,y:16},
 		{x:9,y:15},
 		{x:10,y:15},
 	],
 		
 	pits: [
 		{x:3,y:0},
 		{x:4,y:0},
 		{x:1,y:1},
 		{x:2,y:1},
 		{x:3,y:1},
 		{x:5,y:1},
 		{x:0,y:2},
 		{x:5,y:2},
 		{x:0,y:3},
 		{x:6,y:3},
 		{x:0,y:4},
 		{x:6,y:4},
 		{x:7,y:4},
 		{x:0,y:5},
 		{x:8,y:5},
 		{x:0,y:6},
 		{x:1,y:7},
 		{x:1,y:8},
 		{x:2,y:8},
 		{x:3,y:9},
 		{x:4,y:9},
 		{x:4,y:10},
 		{x:8,y:6},
 		{x:9,y:6},
 		{x:10,y:6},
 		{x:11,y:6},
 		{x:11,y:10},
 		{x:12,y:6},
 		{x:13,y:6},
 		{x:14,y:6},
 		{x:15,y:6},
 		{x:16,y:6},
 		{x:17,y:6},
 		{x:18,y:5},
 		{x:19,y:5},
 		{x:19,y:8},
 		{x:20,y:5},
 		{x:21,y:5},
 		{x:20,y:4},
 		{x:21,y:3},
 		{x:21,y:2},
 		{x:22,y:2},
 		{x:23,y:1},
 		{x:24,y:1},
 		{x:25,y:9},
 		{x:26,y:10},
 		{x:24,y:2},
 		{x:25,y:3},
 		{x:26,y:3},
 		{x:26,y:4},
 		{x:27,y:5},
 		{x:28,y:5},
 		{x:28,y:6},
 		{x:29,y:7},
 		{x:30,y:7},
 		{x:30,y:8},
 		{x:30,y:9},
 		{x:30,y:10},
 		{x:30,y:11},
 		{x:30,y:12},
 		{x:31,y:13},
 		{x:30,y:14},
 		{x:31,y:15},
 		{x:32,y:15},
 		{x:32,y:16},
 		{x:32,y:17},
 		{x:31,y:17},
 		{x:30,y:18},
 		{x:31,y:19},
 		{x:30,y:20},
 		{x:29,y:20},
 		{x:29,y:21},
 		{x:28,y:21},
 		{x:27,y:22},
 		{x:28,y:23},
 		{x:28,y:25},
 		{x:29,y:25},
 		{x:29,y:26},
 		{x:30,y:26},
 		{x:31,y:26},
 		{x:32,y:27},
 		{x:32,y:28},
 		{x:32,y:29},
 		{x:32,y:30},
 		{x:32,y:31},
 		{x:32,y:32},
 		{x:32,y:33},
 		{x:32,y:34},
 		{x:32,y:35},
 		{x:31,y:35},
 		{x:30,y:35},
 		{x:29,y:34},
 		{x:28,y:34},
 		{x:27,y:34},
 		{x:27,y:35},
 		{x:26,y:35},
 		{x:25,y:35},
 		{x:24,y:35},
 		{x:23,y:34},
 		{x:22,y:34},
 		{x:21,y:34},
 		{x:20,y:34},
 		{x:19,y:34},
 		{x:18,y:34},
 		{x:17,y:34},
 		{x:17,y:35},
 		{x:16,y:35},
 		{x:15,y:34},
 		{x:14,y:34},
 		{x:14,y:33},
 		{x:13,y:33},
 		{x:12,y:33},
 		{x:11,y:32},
 		{x:10,y:32},
 		{x:10,y:31},
 		{x:9,y:31},
 		{x:8,y:31},
 		{x:7,y:30},
 		{x:6,y:30},
 		{x:5,y:30},
 		{x:5,y:29},
 		{x:5,y:28},
 		{x:4,y:28},
 		{x:4,y:27},
 		{x:3,y:27},
 		{x:2,y:26},
 		{x:2,y:25},
 		{x:2,y:24},
 		{x:2,y:23},
 		{x:2,y:22},
 		{x:2,y:21},
 		{x:2,y:20},
 		{x:3,y:19},
 		{x:2,y:18},
 		{x:1,y:18},
 		{x:0,y:18},
 		{x:0,y:17},
 		{x:0,y:16},
 		{x:1,y:16},
 		{x:2,y:15},
 		{x:3,y:15},
 		{x:4,y:14},
 		{x:6,y:13},
 		{x:7,y:13},
 		{x:8,y:13},
 		{x:9,y:13},
 		{x:9,y:14},
 		{x:11,y:12},
 		{x:12,y:12},
 		{x:13,y:13},
 		{x:14,y:13},
 		{x:14,y:14},
 		{x:15,y:14},
 		{x:16,y:14},
 		{x:17,y:13},
 		{x:18,y:13},
 		{x:19,y:13},
 		{x:20,y:13},
 		{x:20,y:12},
 		{x:21,y:12},
 		{x:22,y:13},
 		{x:22,y:14},
 		{x:23,y:15},
 		{x:23,y:16},
 		{x:24,y:16},
 		{x:25,y:17},
 		{x:25,y:16},
 		{x:26,y:16},
 		{x:27,y:16},
 		{x:27,y:15},
 		{x:27,y:14},
 		{x:27,y:13},
 		{x:26,y:13},
 		{x:25,y:12},
 		{x:26,y:11},
 		{x:16,y:15},
 		{x:16,y:16},
 		{x:17,y:16},
 		{x:18,y:17},
 		{x:18,y:18},
 		{x:19,y:18},
 		{x:20,y:18},
 		{x:21,y:18},
 		{x:22,y:17},
 		
 		{x:22,y:21},
 		{x:23,y:21},
 		{x:24,y:21},
 		{x:24,y:22},
 		{x:25,y:22},
 		{x:26,y:23},
 		{x:24,y:24},
 		{x:24,y:25},
 		{x:23,y:25},
 		{x:22,y:25},
 		{x:21,y:25},
 		{x:20,y:25},
 		{x:19,y:25},
 		{x:18,y:25},
 		{x:17,y:25},
 		{x:16,y:25},
 		{x:18,y:26},
 		{x:15,y:25},
 		{x:14,y:25},
 		{x:13,y:26},
 		{x:12,y:26},
 		{x:12,y:25},
 		{x:11,y:25},
 		{x:10,y:25},
 		{x:9,y:25},
 		{x:9,y:24},
 		{x:9,y:23},
 		{x:8,y:22},
 		{x:9,y:21},
 		{x:9,y:20},
 	],
 	
 	teams: {
 	
 		player: {
 			id: 'player',
 			truce: ['civilians'],
 		},
 		
 		civilians: {
 			id: 'civilians',
 			truce: ['player','looters','assassins'],
 		},
 		
 		looters: {
 			id: 'looters',
 		},
 		
 		assassins: {
 			id: 'assassins',
 		},
 	
 	},
 	
 	mobs: [
 		
 		{
			x:7,
			y:19,
			type: dataMobs.motherSkullgoblet,
			id: "motherSkullgoblet",
			name: "Mother Skullgoblet",
			team: 'civilians',
			ai: 'dormant',
 		},
 		
 		{
 			x: 1,
 			y: 17,
 			type: dataMobs.looter,
 			id: "looter1",
 			name: "Filthy-mouthed Looter",
			team: 'looters',
 		},
 		
 		{
 			x: 2,
 			y: 17,
 			type: dataMobs.looter,
 			id: "looter2",
 			name: "Shifty-eyed Looter",
			team: 'looters',
 		},
 		
 		{
			x:21,
			y:28,
			type:dataMobs.beulahHill,
			id: "beulahHill",
			name: "Beulah Hill",
			team: 'civilians',
			ai: 'dormant',
 		},
 		
 		{
			x:26,
			y:21,
			type: dataMobs.elderBock,
			id: "elderBock",
			name: "Elder Bock",
			team: 'civilians',
			ai: 'dormant',
 		},
 		
 		{
 			x: 28,
 			y: 35,
 			type: dataMobs.assassin,
 			id: "assassin1",
 			name: "Gnome Assassin",
			team: 'assassins',
 		},
 		
 		{
 			x: 29,
 			y: 35,
 			type: dataMobs.assassin,
 			id: "assassin2",
 			name: "Dwarf Assassin",
			team: 'assassins',
 		},
 		
 		{
 			x:31,
 			y:27,
 			type: dataMobs.daisy,
 			id: 'daisy',
 			name: 'Daisy Moucau',
			team: 'player',
 			ai: 'dormant',
 		},
 		
 		{
			x:27,
			y:21,
			type:dataMobs.guildmasterMoucau,
			id: "guildmasterMoucau",
			name: "Guildmaster Moucau",
			team: 'civilians',
			ai: 'dormant',
 		},
 		
 		{
 			x: 25,
 			y: 9,
 			type: dataMobs.fire,
 			id: 'fire0',
 		},
 		
 		{
 			x: 5,
 			y: 5,
 			type: dataMobs.fire,
 			id: 'fire1',
 		},
 		
 	],
 	
 	triggers: [
 		
 		{
 			x: 19,
 			y: 7,
 			event: 'well',
 		},
 		
 		{
 			x: 20,
 			y: 7,
 			event: 'well',
 		},
 		
 		{
 			x: 18,
 			y: 8,
 			event: 'well',
 		},
 		
 		{
 			x: 20,
 			y: 8,
 			event: 'well',
 		},
 		
 		{
 			x: 19,
 			y: 9,
 			event: 'well',
 		},
 		
 		{
 			x: 20,
 			y: 9,
 			event: 'well',
 		},
 	
 		{
 			x: 28,
 			y: 14,
 			event: 'guildmaster',
 		},
 	
 		{
 			x: 29,
 			y: 14,
 			event: 'guildmaster',
 		},
 	
 		{
 			x: 17,
 			y: 17,
 			event: 'cryForHelp',
 		},
 	
 		{
 			x: 16,
 			y: 18,
 			event: 'cryForHelp',
 		},
 	
 		{
 			x: 16,
 			y: 19,
 			event: 'cryForHelp',
 		},
 		
 		{
 			x: 7,
 			y: 17,
 			event: 'stopThief',
 		},
 		
 		{
 			x: 27,
 			y: 20,
 			event: 'charter',
 		},
 		
 		{
 			x: 28,
 			y: 20,
 			event: 'charter',
 		},
 		
 		{
 			x: 20,
 			y: 4,
 			event: 'assassins',
 		},
 		
 		{
 			x: 21,
 			y: 5,
 			event: 'assassins',
 		},
 		
 		{
 			x: 21,
 			y: 9,
 			event: 'safe',
 		},
 		
 		{
 			x: 5,
 			y: 3,
 			event: 'well',
 		},
 	],
 	
 	events: {
 		
 		well: function() {
 			if (this.equipment.right !== dataItems.pail) {
				view.displayDialogue("Draw pails of water? <br /> <em>Tip: once you have a full pail, you can use the 'Douse' maneuver to help put out the fires.</em>");
				view.nextEvent('well2',mobs.indexOf(this));
				document.getElementById('dialogueContinueButton').innerHTML = "Yes";
				document.getElementById('dialogueCloseButton').innerHTML = "No";
				document.getElementById('dialogueCloseButton').style.display = 'inline';
 			};
 		},
 		
 		well2: function(actor) {
 			actor = mobs[actor];
 			document.getElementById('dialogueBacksplash').style.display = 'none';
 			actor.scabbard = {left:actor.equipment.left,right:actor.equipment.right};
 			actor.equip(dataItems.pail,'left');
 			actor.equip(dataItems.pail,'right');
 			view.refreshMapMobs();
 			view.selectMob(actor);
 			console.log(actor);
 		},
 	
 		guildmaster: function() {
 			view.displayDialogue("There's the guildmaster!",this.name,this.imgBust,"left");
 			view.nextEvent('guildmaster2');
 			map.findHex(8,6).event = undefined;
 			map.findHex(8,7).event = undefined;
 		},
 		
 		guildmaster2: function() {
 			view.displayDialogue("Quick, let's go talk to him before he takes the stage!",heroes[0].name,heroes[0].imgBust,"left");
 		},
 		
 		cryForHelp: function() {
 			view.displayDialogue("Wait, did you hear that?",this.name,this.imgBust,"left");
 			view.nextEvent('cryForHelp2');
 			map.findHex(11,5).event = undefined;
 			map.findHex(11,6).event = undefined;
 			map.findHex(12,7).event = undefined;
 		},
 		
 		cryForHelp2: function() {
 			var skullgoblet = game.findMob('motherSkullgoblet');
 			view.displayDialogue("Help!  Looters! Thieves!  They're ransacking my poor shop!  Help!",skullgoblet.name,skullgoblet.imgBust,"right");
 			view.nextEvent('cryForHelp3');
 		},
 		
 		cryForHelp3: function() {
 			view.displayDialogue("If we get involved, we may miss the Guildmaster.  What do you think?",mobs[1].name,mobs[1].imgBust,"right");
 		},
 		
 		stopThief: function() {
 			var looter1 = game.findMob('looter1');
 			var epithet = this.race;
 			if (this.race === "point") {
 				epithet = "pointy";
 			} else {
 				epithet = "point-lover";
 			};
 			view.displayDialogue("Stay out of our way, "+epithet+"!  This city's going to burn, and we're getting ours while we can.  You should, too!",looter1.name,looter1.imgBust,"left");
 			view.nextEvent('stopThief2');
 			this.location.event = undefined;
//  			document.getElementById('mapBackgroundImg').src='img/theCityRevolts2.png';
 		},
 		
 		stopThief2: function() {
 			view.displayDialogue("This is my neighborhood, punk.  You're not going to steal from Mother Skullgoblet on my watch!",view.focus.mob.name,view.focus.mob.imgBust,"right");
 			map.findHex(8,10).event = theCityRevolts.events.thankYou;
 		},
 		
 		thankYou: function() {
 			var looter1 = game.findMob('looter1');
 			var looter2 = game.findMob('looter2');
 			var skullgoblet = game.findMob('motherSkullgoblet');
 			if (looter1.stats.morale === 0 && looter2.stats.morale === 0) {
 				view.displayDialogue("Oh, thank you, thank you!  I take back every disparaging thing I ever said about you two rascals.",skullgoblet.name,skullgoblet.imgBust,"right");
 				this.location.event = undefined;
 				view.nextEvent('welcome',this);
 			};
 		},
 		
 		welcome: function() {
 			view.displayDialogue("You're... welcome, I guess.  What... what disparaging things have you been... you know, never mind.  What should we do with these two?",this.name,this.imgBust,"left");
 			view.nextEvent('welcome2',this);
 		},
 		
 		welcome2: function() {
 			var skullgoblet = game.findMob('motherSkullgoblet');
 			view.displayDialogue("Oh, you leave them to me.  I can't run and chase 'em, but I can give them the whupping they deserve now that they stay still.  You two come back by the shop later.  I'll remember this!",skullgoblet.name,skullgolet.imgBust,"right");
 			company.deeds.skullgoblet = true;
 		},
 		
 		charter: function() {
 			view.displayDialogue("Excuse me!  Master Moucau!  Master Moucau!",this.name,this.imgBust,"left");
 			view.nextEvent('charter2');
 			this.location.event = undefined;
 		},
 		
 		charter2: function() {
 			var guildmasterMoucau = game.findMob('guildmasterMoucau');
 			view.displayDialogue("Yes?  So glad to see you come out for this!  Let me shake your hand before I go up on stage right now.",guildmasterMoucau.name,guildmasterMoucau.imgBust,"right");
 			view.nextEvent('charter3');
 		},
 		
 		charter3: function() {
 			view.displayDialogue("We're hoping for more than a handshake, Master.  My name is "+mobs[0].name+", this is my friend Mixter Stout.  We're hoping to register a charter for a fighting company.  We want to help the city.  Defend it, fight the Ogre King, preserve the Pileus way of life!",mobs[0].name,mobs[0].imgBust,"left");
 			view.nextEvent('charter4');
 		},
 		
 		charter4: function() {
 			var guildmasterMoucau = game.findMob('guildmasterMoucau');
 			view.displayDialogue("Right... well.  I suppose I could accept your petition.  Right after you supply the thousand gold piece registration fee.",guildmasterMoucau.name,guildmasterMoucau.imgBust,"right");
 			view.nextEvent('charter5');
 		},
 		
 		charter5: function() {
 			view.displayDialogue("Th... thousa... I'm sorry, one <em>thousand</em> gold pieces?!?  Just to join the fight to protect our city?",mobs[0].name,mobs[0].imgBust,"left");
 			view.nextEvent('charter6');
 		},
 		
 		charter6: function() {
 			var stout = game.findMob('stout');
 			view.displayDialogue("Oooooohhh, I get it.  The city registering all these companies isn't a call to arms, it's a tax scheme.",stout.name,stout.imgBust,"left");
 			view.nextEvent('charter7');
 		},
 		
 		charter7: function() {
 			var guildmasterMoucau = game.findMob('guildmasterMoucau');
 			view.displayDialogue("You're very sharp.  The city will need full coffers to fund our defense.<p>I wish I could help you kids.  I will say the City Watch is always accepting strong arms.  Why don't you inquire there?  But I'm afraid I've got to go.",guildmasterMoucau.name,guildmasterMoucau.imgBust,"right");
 			view.nextEvent('charter8');
 		},
 		
 		charter8: function() {
 			var guildmasterMoucau = game.findMob('guildmasterMoucau');
 			var stage = map.findHex(21,2);
 			guildmasterMoucau.stats.move = 8;
 			guildmasterMoucau.move(stage);
 			var stageSteps = map.findHex(16,2);
 			var elderBock = game.findMob('elderBock');
 			elderBock.move(stageSteps);
 			handlers.hideDialogueDiv();
 		},
 		
 		assassins: function() {
 			var assassin1 = game.findMob('assassin1');
 			var assassin2 = game.findMob('assassin2');
 			var landingHex1 = map.findHex(20,2);
 			var landingHex2 = map.findHex(22,2);
 			
 			view.moveMob(assassin1,landingHex1);
 			assassin1.location = landingHex1;
 			view.moveMob(assassin2,landingHex2);
 			assassin2.location = landingHex2;
 			
 			view.displayDialogue("Death to the Traitor Council!  Death to the Betrayer Guildmasters!  Long Live the Ogre King!",assassin1.name,assassin1.imgBust,"left");
 			view.nextEvent('assassins2');
 			
 			map.findHex(20,4).event = undefined;
 			map.findHex(21,5).event = undefined;
 		},
 		
 		assassins2: function() {
 			var elderBock = game.findMob('elderBock');
 			elderBock.move(map.findHex(18,2));
 			var guildmasterMoucau = game.findMob('guildmasterMoucau');
 			view.displayDialogue("Shit!",guildmasterMoucau.name,guildmasterMoucau.imgBust,"right");
 			view.nextEvent('assassins3');
 		},
 		
 		assassins3: function() {
 			var guildmasterMoucau = game.findMob('guildmasterMoucau');
 			view.moveMob(guildmasterMoucau,map.findHex(21,4));
 			view.displayDialogue("Help me!  "+mobs[0].name+", save me!",guildmasterMoucau.name,guildmasterMoucau.imgBust,"right");
 			view.nextEvent('assassins4');
 		},
 		
 		assassins4: function() {
 			handlers.hideDialogueDiv();
 			var guildmasterMoucau = game.findMob('guildmasterMoucau');
//  			guildmasterMoucau.stats.move = 8;
//  			guildmasterMoucau.move(map.findHex(20,9));
//				This really should be an AI that takes him across the map in a few moves
			var hideyHole = map.findHex(20,9);
			view.moveMob(guildmasterMoucau,hideyHole);
			guildmasterMoucau.location = hideyHole;
 			
 			var assassin1 = game.findMob('assassin1');
 			var assassin2 = game.findMob('assassin2');
 			var landingHex1 = map.findHex(21,4);
 			var landingHex2 = map.findHex(22,4);
 			view.moveMob(assassin1,landingHex1);
 			assassin1.location = landingHex1;
 			view.moveMob(assassin2,landingHex2);
 			assassin2.location = landingHex2;
 			
 			var daisy = game.findMob('daisy');
 			view.displayDialogue("Keep your filthy loyalist hands off my father!",daisy.name,daisy.imgBust,"right");
 			view.nextEvent('daisyJoin');
 		},
 		
 		daisyJoin: function() {
 			var daisy = game.findMob('daisy');
  			view.displayDialogue("Daisy has joined the party!",undefined,daisy.imgBust,"right");
  			daisy.player = true;
  			daisy.look(daisy.location);
 		},
 		
 		safe: function() {
 			var assassin1 = game.findMob('assassin1');
 			var assassin2 = game.findMob('assassin2');
 			if (assassin1.stats.morale === 0 && assassin2.stats.morale === 0) {
 				var guildmasterMoucau = game.findMob('guildmasterMoucau');
 				view.displayDialogue("I owe you my life!  Thank you, thank you!<p>You know what?  I'll pay your registration fee and get you that charter.  I think this city needs brave heroes like you!",guildmasterMoucau.name,guildmasterMoucau.img,"left");
 				view.nextEvent('andMyAxe');
 			};
 		},
 		
 		andMyAxe: function() {
 			view.displayDialogue("If you'll be fighting the cowards that tried to kill my father, I'll join your ranks.  Do we have a 401k?",daisy.name,daisy.img,"right");
 			view.nextEvent('welcomeAboard');
 		},
 		
 		welcomeAboard: function() {
 			view.displayDialogue("Welcome aboard.  Gotta warn you, we live here in Orktown.  But we're happy to have you.",mobs[0].name,mobs[0].img,"left");
 			view.setupReturn();
 		},
 	},
 
 };